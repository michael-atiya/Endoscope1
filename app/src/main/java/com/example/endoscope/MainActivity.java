package com.example.endoscope;

import androidx.appcompat.app.AppCompatActivity;

import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Color;
import android.os.Bundle;
import android.os.Handler;
import android.view.View;
import android.widget.Button;
import android.widget.ImageView;
import android.widget.TextView;

import com.example.endoscope.databinding.ActivityMainBinding;

import org.w3c.dom.Text;

import java.util.Random;

public class MainActivity extends AppCompatActivity {

    // Used to load the 'endoscope' library on application startup.
    static {
        System.loadLibrary("endoscope");
    }

    private int[] imageArray = {R.drawable.scene00001, R.drawable.scene00002,
            R.drawable.scene00003,
            R.drawable.scene00004,
            R.drawable.scene00005,
            R.drawable.scene00006,
            R.drawable.scene00007,
            R.drawable.scene00008,
            R.drawable.scene00009,
            R.drawable.scene00010,
            R.drawable.scene00011,
            R.drawable.scene00012,
            R.drawable.scene00013,
            R.drawable.scene00014,
            R.drawable.scene00015,
            R.drawable.scene00016,
            R.drawable.scene00017,
            R.drawable.scene00018,
            R.drawable.scene00019,
            R.drawable.scene00020,
            R.drawable.scene00021,
            R.drawable.scene00022,
            R.drawable.scene00023,
            R.drawable.scene00024,
            R.drawable.scene00025,
            R.drawable.scene00026,
            R.drawable.scene00027,
            R.drawable.scene00028,
            R.drawable.scene00029,
            R.drawable.scene00030,
            R.drawable.scene00031,
            R.drawable.scene00032,
            R.drawable.scene00033,
            R.drawable.scene00034,
            R.drawable.scene00035,
            R.drawable.scene00036,
            R.drawable.scene00037,
            R.drawable.scene00038,
            R.drawable.scene00039,
            R.drawable.scene00040,
            R.drawable.scene00041,
            R.drawable.scene00042,
            R.drawable.scene00043,
            R.drawable.scene00044,
            R.drawable.scene00045,
            R.drawable.scene00046,
            R.drawable.scene00047,
            R.drawable.scene00048,
            R.drawable.scene00049,
            R.drawable.scene00050,
            R.drawable.scene00051,
            R.drawable.scene00052,
            R.drawable.scene00053,
            R.drawable.scene00054,
            R.drawable.scene00055,
            R.drawable.scene00056,
            R.drawable.scene00057,
            R.drawable.scene00058,
            R.drawable.scene00059,
            R.drawable.scene00060,
            R.drawable.scene00061,
            R.drawable.scene00062,
            R.drawable.scene00063,
            R.drawable.scene00064,
            R.drawable.scene00065,
            R.drawable.scene00066,
            R.drawable.scene00067,
            R.drawable.scene00068,
            R.drawable.scene00069,
            R.drawable.scene00070,
            R.drawable.scene00071,
            R.drawable.scene00072,
            R.drawable.scene00073,
            R.drawable.scene00074,
            R.drawable.scene00075,
            R.drawable.scene00076,
            R.drawable.scene00077,
            R.drawable.scene00078,
            R.drawable.scene00079,
            R.drawable.scene00080,
            R.drawable.scene00081,
            R.drawable.scene00082,
            R.drawable.scene00083,
            R.drawable.scene00084,
            R.drawable.scene00085,
            R.drawable.scene00086,
            R.drawable.scene00087,
            R.drawable.scene00088,
            R.drawable.scene00089,
            R.drawable.scene00090,
            R.drawable.scene00091,
            R.drawable.scene00092,
            R.drawable.scene00093,
            R.drawable.scene00094,
            R.drawable.scene00095,
            R.drawable.scene00096,
            R.drawable.scene00097,
            R.drawable.scene00098,
            R.drawable.scene00099,
            R.drawable.scene00100,
            R.drawable.scene00101,
            R.drawable.scene00102,
            R.drawable.scene00103,
            R.drawable.scene00104,
            R.drawable.scene00105,
            R.drawable.scene00106,
            R.drawable.scene00107,
            R.drawable.scene00108,
            R.drawable.scene00109,
            R.drawable.scene00110,
            R.drawable.scene00111,
            R.drawable.scene00112,
            R.drawable.scene00113,
            R.drawable.scene00114,
            R.drawable.scene00115,
            R.drawable.scene00116,
            R.drawable.scene00117,
            R.drawable.scene00118,
            R.drawable.scene00119,
            R.drawable.scene00120,
            R.drawable.scene00121,
            R.drawable.scene00122,
            R.drawable.scene00123,
            R.drawable.scene00124,
            R.drawable.scene00125,
            R.drawable.scene00126,
            R.drawable.scene00127,
            R.drawable.scene00128,
            R.drawable.scene00129,
            R.drawable.scene00130,
            R.drawable.scene00131,
            R.drawable.scene00132,
            R.drawable.scene00133,
            R.drawable.scene00134,
            R.drawable.scene00135,
            R.drawable.scene00136,
            R.drawable.scene00137,
            R.drawable.scene00138,
            R.drawable.scene00139,
            R.drawable.scene00140,
            R.drawable.scene00141,
            R.drawable.scene00142,
            R.drawable.scene00143,
            R.drawable.scene00144,
            R.drawable.scene00145,
            R.drawable.scene00146,
            R.drawable.scene00147,
            R.drawable.scene00148,
            R.drawable.scene00149,
            R.drawable.scene00150,
            R.drawable.scene00151,
            R.drawable.scene00152,
            R.drawable.scene00153,
            R.drawable.scene00154,
            R.drawable.scene00155,
            R.drawable.scene00156,
            R.drawable.scene00157,
            R.drawable.scene00158,
            R.drawable.scene00159,
            R.drawable.scene00160,
            R.drawable.scene00161,
            R.drawable.scene00162,
            R.drawable.scene00163,
            R.drawable.scene00164,
            R.drawable.scene00165,
            R.drawable.scene00166,
            R.drawable.scene00167,
            R.drawable.scene00168,
            R.drawable.scene00169,
            R.drawable.scene00170,
            R.drawable.scene00171,
            R.drawable.scene00172,
            R.drawable.scene00173,
            R.drawable.scene00174,
            R.drawable.scene00175,
            R.drawable.scene00176,
            R.drawable.scene00177,
            R.drawable.scene00178,
            R.drawable.scene00179,
            R.drawable.scene00180,
            R.drawable.scene00181,
            R.drawable.scene00182,
            R.drawable.scene00183,
            R.drawable.scene00184,
            R.drawable.scene00185,
            R.drawable.scene00186,
            R.drawable.scene00187,
            R.drawable.scene00188,
            R.drawable.scene00189,
            R.drawable.scene00190,
            R.drawable.scene00191,
            R.drawable.scene00192,
            R.drawable.scene00193,
            R.drawable.scene00194,
            R.drawable.scene00195,
            R.drawable.scene00196,
            R.drawable.scene00197,
            R.drawable.scene00198,
            R.drawable.scene00199,
            R.drawable.scene00200,
            R.drawable.scene00201,
            R.drawable.scene00202,
            R.drawable.scene00203,
            R.drawable.scene00204,
            R.drawable.scene00205,
            R.drawable.scene00206,
            R.drawable.scene00207,
            R.drawable.scene00208,
            R.drawable.scene00209,
            R.drawable.scene00210,
            R.drawable.scene00211,
            R.drawable.scene00212,
            R.drawable.scene00213,
            R.drawable.scene00214,
            R.drawable.scene00215,
            R.drawable.scene00216,
            R.drawable.scene00217,
            R.drawable.scene00218,
            R.drawable.scene00219,
            R.drawable.scene00220,
            R.drawable.scene00221,
            R.drawable.scene00222,
            R.drawable.scene00223,
            R.drawable.scene00224,
            R.drawable.scene00225,
            R.drawable.scene00226,
            R.drawable.scene00227,
            R.drawable.scene00228,
            R.drawable.scene00229,
            R.drawable.scene00230,
            R.drawable.scene00231,
            R.drawable.scene00232,
            R.drawable.scene00233,
            R.drawable.scene00234,
            R.drawable.scene00235,
            R.drawable.scene00236,
            R.drawable.scene00237,
            R.drawable.scene00238,
            R.drawable.scene00239,
            R.drawable.scene00240,
            R.drawable.scene00241,
            R.drawable.scene00242,
            R.drawable.scene00243,
            R.drawable.scene00244,
            R.drawable.scene00245,
            R.drawable.scene00246,
            R.drawable.scene00247,
            R.drawable.scene00248,
            R.drawable.scene00249,
            R.drawable.scene00250,
            R.drawable.scene00251,
            R.drawable.scene00252,
            R.drawable.scene00253,
            R.drawable.scene00254,
            R.drawable.scene00255,
            R.drawable.scene00256,
            R.drawable.scene00257,
            R.drawable.scene00258,
            R.drawable.scene00259,
            R.drawable.scene00260,
            R.drawable.scene00261,
            R.drawable.scene00262,
            R.drawable.scene00263,
            R.drawable.scene00264,
            R.drawable.scene00265,
            R.drawable.scene00266,
            R.drawable.scene00267,
            R.drawable.scene00268,
            R.drawable.scene00269,
            R.drawable.scene00270,
            R.drawable.scene00271,
            R.drawable.scene00272,
            R.drawable.scene00273,
            R.drawable.scene00274,
            R.drawable.scene00275,
            R.drawable.scene00276,
            R.drawable.scene00277,
            R.drawable.scene00278,
            R.drawable.scene00279,
            R.drawable.scene00280,
            R.drawable.scene00281,
            R.drawable.scene00282,
            R.drawable.scene00283,
            R.drawable.scene00284,
            R.drawable.scene00285,
            R.drawable.scene00286,
            R.drawable.scene00287,
            R.drawable.scene00288,
            R.drawable.scene00289,
            R.drawable.scene00290,
            R.drawable.scene00291,
            R.drawable.scene00292,
            R.drawable.scene00293,
            R.drawable.scene00294,
            R.drawable.scene00295,
            R.drawable.scene00296,
            R.drawable.scene00297,
            R.drawable.scene00298,
            R.drawable.scene00299,
            R.drawable.scene00300,
            R.drawable.scene00301,
            R.drawable.scene00302,
            R.drawable.scene00303,
            R.drawable.scene00304,
            R.drawable.scene00305,
            R.drawable.scene00306,
            R.drawable.scene00307,
            R.drawable.scene00308,
            R.drawable.scene00309,
            R.drawable.scene00310,
            R.drawable.scene00311,
            R.drawable.scene00312,
            R.drawable.scene00313,
            R.drawable.scene00314,
            R.drawable.scene00315,
            R.drawable.scene00316,
            R.drawable.scene00317,
            R.drawable.scene00318,
            R.drawable.scene00319,
            R.drawable.scene00320,
            R.drawable.scene00321,
            R.drawable.scene00322,
            R.drawable.scene00323,
            R.drawable.scene00324,
            R.drawable.scene00325,
            R.drawable.scene00326,
            R.drawable.scene00327,
            R.drawable.scene00328,
            R.drawable.scene00329,
            R.drawable.scene00330,
            R.drawable.scene00331,
            R.drawable.scene00332,
            R.drawable.scene00333,
            R.drawable.scene00334,
            R.drawable.scene00335,
            R.drawable.scene00336,
            R.drawable.scene00337,
            R.drawable.scene00338,
            R.drawable.scene00339,
            R.drawable.scene00340,
            R.drawable.scene00341,
            R.drawable.scene00342,
            R.drawable.scene00343,
            R.drawable.scene00344,
            R.drawable.scene00345,
            R.drawable.scene00346,
            R.drawable.scene00347,
            R.drawable.scene00348,
            R.drawable.scene00349,
            R.drawable.scene00350,
            R.drawable.scene00351,
            R.drawable.scene00352,
            R.drawable.scene00353,
            R.drawable.scene00354,
            R.drawable.scene00355,
            R.drawable.scene00356,
            R.drawable.scene00357,
            R.drawable.scene00358,
            R.drawable.scene00359,
            R.drawable.scene00360,
            R.drawable.scene00361,
            R.drawable.scene00362,
            R.drawable.scene00363,
            R.drawable.scene00364,
            R.drawable.scene00365,
            R.drawable.scene00366,
            R.drawable.scene00367,
            R.drawable.scene00368,
            R.drawable.scene00369,
            R.drawable.scene00370,
            R.drawable.scene00371,
            R.drawable.scene00372,
            R.drawable.scene00373,
            R.drawable.scene00374,
            R.drawable.scene00375,
            R.drawable.scene00376,
            R.drawable.scene00377,
            R.drawable.scene00378,
            R.drawable.scene00379,
            R.drawable.scene00380,
            R.drawable.scene00381,
            R.drawable.scene00382,
            R.drawable.scene00383,
            R.drawable.scene00384,
            R.drawable.scene00385,
            R.drawable.scene00386,
            R.drawable.scene00387,
            R.drawable.scene00388,
            R.drawable.scene00389,
            R.drawable.scene00390,
            R.drawable.scene00391,
            R.drawable.scene00392,
            R.drawable.scene00393,
            R.drawable.scene00394,
            R.drawable.scene00395,
            R.drawable.scene00396,
            R.drawable.scene00397,
            R.drawable.scene00398,
            R.drawable.scene00399,
            R.drawable.scene00400,
            R.drawable.scene00401,
            R.drawable.scene00402,
            R.drawable.scene00403,
            R.drawable.scene00404,
            R.drawable.scene00405,
            R.drawable.scene00406,
            R.drawable.scene00407,
            R.drawable.scene00408,
            R.drawable.scene00409,
            R.drawable.scene00410,
            R.drawable.scene00411,
            R.drawable.scene00412,
            R.drawable.scene00413,
            R.drawable.scene00414,
            R.drawable.scene00415,
            R.drawable.scene00416,
            R.drawable.scene00417,
            R.drawable.scene00418,
            R.drawable.scene00419,
            R.drawable.scene00420,
            R.drawable.scene00421,
            R.drawable.scene00422,
            R.drawable.scene00423,
            R.drawable.scene00424,
            R.drawable.scene00425,
            R.drawable.scene00426,
            R.drawable.scene00427,
            R.drawable.scene00428,
            R.drawable.scene00429,
            R.drawable.scene00430,
            R.drawable.scene00431,
            R.drawable.scene00432,
            R.drawable.scene00433,
            R.drawable.scene00434,
            R.drawable.scene00435,
            R.drawable.scene00436,
            R.drawable.scene00437,
            R.drawable.scene00438,
            R.drawable.scene00439,
            R.drawable.scene00440,
            R.drawable.scene00441,
            R.drawable.scene00442,
            R.drawable.scene00443,
            R.drawable.scene00444,
            R.drawable.scene00445,
            R.drawable.scene00446,
            R.drawable.scene00447,
            R.drawable.scene00448,
            R.drawable.scene00449,
            R.drawable.scene00450,
            R.drawable.scene00451,
            R.drawable.scene00452,
            R.drawable.scene00453,
            R.drawable.scene00454,
            R.drawable.scene00455,
            R.drawable.scene00456,
            R.drawable.scene00457,
            R.drawable.scene00458,
            R.drawable.scene00459,
            R.drawable.scene00460,
            R.drawable.scene00461,
            R.drawable.scene00462,
            R.drawable.scene00463,
            R.drawable.scene00464,
            R.drawable.scene00465,
            R.drawable.scene00466,
            R.drawable.scene00467,
            R.drawable.scene00468,
            R.drawable.scene00469,
            R.drawable.scene00470,
            R.drawable.scene00471,
            R.drawable.scene00472,
            R.drawable.scene00473,
            R.drawable.scene00474,
            R.drawable.scene00475,
            R.drawable.scene00476,
            R.drawable.scene00477,
            R.drawable.scene00478,
            R.drawable.scene00479,
            R.drawable.scene00480,
            R.drawable.scene00481,
            R.drawable.scene00482,
            R.drawable.scene00483,
            R.drawable.scene00484,
            R.drawable.scene00485,
            R.drawable.scene00486,
            R.drawable.scene00487,
            R.drawable.scene00488,
            R.drawable.scene00489,
            R.drawable.scene00490,
            R.drawable.scene00491,
            R.drawable.scene00492,
            R.drawable.scene00493,
            R.drawable.scene00494,
            R.drawable.scene00495,
            R.drawable.scene00496,
            R.drawable.scene00497,
            R.drawable.scene00498,
            R.drawable.scene00499,
            R.drawable.scene00500,
            R.drawable.scene00501,
            R.drawable.scene00502,
            R.drawable.scene00503,
            R.drawable.scene00504,
            R.drawable.scene00505,
            R.drawable.scene00506,
            R.drawable.scene00507,
            R.drawable.scene00508,
            R.drawable.scene00509,
            R.drawable.scene00510,
            R.drawable.scene00511,
            R.drawable.scene00512,
            R.drawable.scene00513,
            R.drawable.scene00514,
            R.drawable.scene00515,
            R.drawable.scene00516,
            R.drawable.scene00517,
            R.drawable.scene00518,
            R.drawable.scene00519,
            R.drawable.scene00520,
            R.drawable.scene00521,
            R.drawable.scene00522,
            R.drawable.scene00523,
            R.drawable.scene00524,
            R.drawable.scene00525,
            R.drawable.scene00526,
            R.drawable.scene00527,
            R.drawable.scene00528,
            R.drawable.scene00529,
            R.drawable.scene00530,
            R.drawable.scene00531,
            R.drawable.scene00532,
            R.drawable.scene00533,
            R.drawable.scene00534,
            R.drawable.scene00535,
            R.drawable.scene00536,
            R.drawable.scene00537,
            R.drawable.scene00538,
            R.drawable.scene00539,
            R.drawable.scene00540,
            R.drawable.scene00541,
            R.drawable.scene00542,
            R.drawable.scene00543,
            R.drawable.scene00544,
            R.drawable.scene00545,
            R.drawable.scene00546,
            R.drawable.scene00547,
            R.drawable.scene00548,
            R.drawable.scene00549,
            R.drawable.scene00550,
            R.drawable.scene00551,
            R.drawable.scene00552,
            R.drawable.scene00553,
            R.drawable.scene00554,
            R.drawable.scene00555,
            R.drawable.scene00556,
            R.drawable.scene00557,
            R.drawable.scene00558,
            R.drawable.scene00559,
            R.drawable.scene00560,
            R.drawable.scene00561,
            R.drawable.scene00562,
            R.drawable.scene00563,
            R.drawable.scene00564,
            R.drawable.scene00565,
            R.drawable.scene00566,
            R.drawable.scene00567,
            R.drawable.scene00568,
            R.drawable.scene00569,
            R.drawable.scene00570,
            R.drawable.scene00571,
            R.drawable.scene00572,
            R.drawable.scene00573,
            R.drawable.scene00574,
            R.drawable.scene00575,
            R.drawable.scene00576,
            R.drawable.scene00577,
            R.drawable.scene00578,
            R.drawable.scene00579,
            R.drawable.scene00580,
            R.drawable.scene00581,
            R.drawable.scene00582,
            R.drawable.scene00583,
            R.drawable.scene00584};

    private final int[] count = {0};
    private final int[] play = {0};

    private Handler handler = new Handler();
    //private Handler handler2 = new Handler();
    private ImageView imageView;
    private Button playbutton;
    private Button rewindbutton;




    private ActivityMainBinding binding;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        binding = ActivityMainBinding.inflate(getLayoutInflater());
        setContentView(binding.getRoot());
        imageView = (ImageView) findViewById(R.id.imageView);
        playbutton = (Button) findViewById(R.id.button);
        rewindbutton = (Button) findViewById(R.id.button2);
        runnable.run();
        //runnable2.run();


        // Example of a call to a native method
        //TextView tv = binding.sampleText;
        //tv.setText(stringFromJNI());
    }

    private Runnable runnable = new Runnable() {
        @Override
        public void run() {
            Random random = new Random();

            int h = 400;
            int w = 400;

            int[] colors = new int[h*w];
            for(int i = 0; i < h*w; i++)
            {
                colors[i] = Color.rgb(random.nextInt(255), random.nextInt(255), random.nextInt(255));
            }

            Bitmap myBitmap = Bitmap.createBitmap(colors, 400, 400, Bitmap.Config.HARDWARE);

            imageView.setImageResource(imageArray[count[0]]);
            //imageView.setImageBitmap(myBitmap);
            if (play[0] == 1 && count[0] < 583) // 583 is length of image array
            {
                count[0] += 1;
            }
            rewindbutton.setOnClickListener(new View.OnClickListener() {
                @Override
                public void onClick(View view) {// if rewind button is clicked rewind 50 frames prior to currrent
                    if (count[0] >= 50)
                    {
                        count[0] -= 50;
                    }
                }
            });
            playbutton.setOnClickListener(new View.OnClickListener() {
                @Override
                public void onClick(View view) {
                    if (play[0] == 0)//play = 0 means its paused so when button is clicked then it plays one image after another
                    {
                        play[0] = 1;
                        playbutton.setText("Puase");
                    }
                    else// if its already playing then it will pause when clicked again and change button text
                    {
                        play[0] = 0;
                        playbutton.setText("Play");
                    }
                }
            });
            handler.postDelayed(this, 100/3);
        }
    };

//    private Runnable runnable2 = new Runnable() {// 2nd runnable interface for running decode function
//        @Override
//        public void run() {
//
//        }
//    };

    public native String stringFromJNI();

    public native void decode();


}